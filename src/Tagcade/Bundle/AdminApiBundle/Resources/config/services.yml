services:
    # main public services

    tagcade_admin_api.handler.user:
        class: Tagcade\Bundle\AdminApiBundle\Handler\UserHandler
        parent: tagcade.handler.handler_abstract
        public: true
        arguments:
            - @form.factory
            - @tagcade_admin_api.form.type.user
            - @tagcade_user.domain_manager.publisher

    # forms

    tagcade_admin_api.form.type.user:
        class: Tagcade\Bundle\AdminApiBundle\Form\Type\UserFormType
        arguments:
            - @=service('security.context').getToken().getUser()
        tags:
            - { name: form.type, alias: tagcade_form_admin_api_user }

    tagcade_admin_api.event_listener.action_log_event_listener:
        class: Tagcade\Bundle\AdminApiBundle\EventListener\ActionLogEventListener
        arguments:
            - @=service('security.context').getToken().getUser()
            - @doctrine.orm.entity_manager
            - @request_stack
        tags:
            - { name: kernel.event_listener, event: tagcade.events.handler_event, method: onHandlerEvent }
            - { name: kernel.event_listener, event: tagcade_user.events.login_success, method: onHandlerEvent }

