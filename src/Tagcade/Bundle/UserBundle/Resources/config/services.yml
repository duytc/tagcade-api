parameters:
    tagcade_user.user.class: Tagcade\Model\User\UserInterface
    tagcade_user.user.factory.class: Tagcade\Factory\UserFactory

    tagcade_user.event.authentication_success_listener.class: Tagcade\Bundle\UserBundle\EventListener\AuthenticationSuccessListener

services:
    tagcade_user.factory.role:
        class: "%tagcade_user.user.class%"
        factory_class:  "%tagcade_user.user.factory.class%"
        factory_method: getRole
        arguments: ["@=service('security.context').getToken() != null ? service('security.context').getToken().getUser() : null"]

    tagcade_user.event.authentication_success_listener:
        class: %tagcade_user.event.authentication_success_listener.class%
        arguments: [@fos_user.user_manager]
        tags:
            -
                name: kernel.event_listener
                event: 'lexik_jwt_authentication.on_authentication_success'
                method: 'onAuthenticationSuccess'
                priority: 10