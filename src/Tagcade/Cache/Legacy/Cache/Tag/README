Copied from legacy code to be compatible with existing systems, will be refactored.